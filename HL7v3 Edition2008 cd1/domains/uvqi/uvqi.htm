<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
   <head>
      <link rel="stylesheet" type="text/css" href="../../support/css/v3m.css" title="v3m" /><script src="../../support/js/tree.js" type="text/javascript"></script><script src="../../support/js/setTopFrameText.js" type="text/javascript"></script><script src="../../support/js/swapcss.js" type="text/javascript"></script><script type="text/javascript">
			if (find('heading')) setHeadingTextFromFileName(document.location.href);
			</script><title>Domain: Query Infrastructure</title>
   </head>
   <body>
      <div class="section">
         <h1>Domain: Query Infrastructure</h1>
         <table cellspacing="0" cellpadding="3" border="1">
            <tr>
               <td align="center"><img src="../../support/graphics/ansilogo.gif" alt="ANSI" /><br />ANSI/HL7 V3 IM, R1-2004<br />HL7 Version 3 Standard: Infrastructure Management: Query Infrastructure<br />10/20/2004<img width="5" alt="spacer" src="../../support/graphics/spacer.gif" /></td>
            </tr>
         </table>
         <table style="border-width:0" width="100%" cellpadding="6">
            <tr>
               <td valign="top" align="left">Control Query Co-Chair</td>
               <td valign="top" align="left">Graham Grieve<br />Kestral Computing Pty Ltd.
               </td>
            </tr>
            <tr>
               <td valign="top" align="left">Control Query Co-Chair</td>
               <td valign="top" align="left">Mike Henderson<br />Eastern Informatics
               </td>
            </tr>
            <tr>
               <td valign="top" align="left">Control Query Co-Chair</td>
               <td valign="top" align="left">Joann Larson<br />Kaiser Permanente
               </td>
            </tr>
            <tr>
               <td valign="top" align="left">Primary Contributor</td>
               <td valign="top" align="left">Dale Nelson<br />Zed-Logic Informatics, LLC
               </td>
            </tr>
            <tr>
               <td valign="top" align="left">Control Query Co-Chair</td>
               <td valign="top" align="left">Jennifer Puyenbroek<br />McKesson Information Solutions
               </td>
            </tr>
            <tr>
               <td valign="top" align="left">Primary Contributor</td>
               <td valign="top" align="left">Larry Reis<br />LR Consulting
               </td>
            </tr>
            <tr>
               <td valign="top" align="left">Primary Contributor</td>
               <td valign="top" align="left">Mark Shafarman<br />Oracle Corporation
               </td>
            </tr>
            <tr>
               <td valign="top" align="left">Control Query Co-Chair</td>
               <td valign="top" align="left">Rene Spronk<br />Ringholm, GmbH
               </td>
            </tr>
            <tr>
               <td valign="top" align="left">Primary Contributor</td>
               <td valign="top" align="left">Mark Tucker<br />Regenstrief Institute for Health Care
               </td>
            </tr>
         </table>
         <p class="copyright">Last Published: 06/23/2008 1:55 PM</p>
         <p class="lastEdit">Content Last Edited: 6/20/2005 7:05:04 PM</p>
         <p class="copyright">HL7® Version 3 Standard, © 2008 Health 
            Level Seven®, Inc.  All Rights Reserved.
         </p>
         <p class="copyright">HL7 and Health Level Seven are registered 
            trademarks of Health Level Seven, Inc.  Reg. U.S. Pat &amp; TM Off
         </p>
         <hr title="Separator for header" />
         <h2><a name="contents">Table of Contents</a></h2><br /><a href="#prefBegin">Preface</a><br /><span>    i  <a href="UVQI.htm#prefNotes">Notes to Readers</a><br /></span><span>    ii  <a href="UVQI.htm#navigate-divs">Message Design Element Navigation</a><br /></span>1  <a href="UVQI.htm#intro-QUQI_DO000003UV-ic">Overview</a><br />    1.1  <a href="UVQI.htm#spec-scope">Introduction &amp; Scope</a><br />
         			    1.2  <a href="UVQI.htm#dmims-QUQI_DO000003UV-ic">Domain Message Information Models</a><br />2.  <a href="UVQI_QueryByParameter.htm#QUQI_DO000003UV-QueryByParameter-ic">Query By Parameter Topic</a><br /><span>    2.1  <a href="UVQI_QueryByParameter.htm#sbs-QUQI_DO000003UV-QueryByParameter-ic">Storyboards</a><br /></span><span>    2.2  <a href="UVQI_QueryByParameter.htm#roles-QUQI_DO000003UV-QueryByParameter-ic">Application Roles</a><br /></span><span>    2.3  <a href="UVQI_QueryByParameter.htm#tes-QUQI_DO000003UV-QueryByParameter-ic">Trigger Events</a><br /></span><span>    2.4  <a href="UVQI_QueryByParameter.htm#rmims-QUQI_DO000003UV-QueryByParameter-ic">Refined Message Information Models</a><br /></span><span>    2.5  <a href="UVQI_QueryByParameter.htm#hmds-QUQI_DO000003UV-QueryByParameter-ic">Hierarchical Message Descriptions</a><br /></span><span>    2.6  <a href="UVQI_QueryByParameter.htm#ints-QUQI_DO000003UV-QueryByParameter-ic">Interactions</a><br /></span>3.  <a href="UVQI_DO_CT.htm#QUQI_DO000003UV-ic">Common Message Elements Annex<br /></a>
         		    3.1  <a href="UVQI_DO_CT.htm#QUQI_DO000003UV-icc2id">CMETs Used In This Domain</a><br />4.  <a href="UVQI_DO_XX.htm#indx-QUQI_DO000003UV-ic">Interaction Annex</a><br />
         		    4.1  <a href="UVQI_DO_XX.htm#QUQI_DO000003UV-ic1id">By Application Role</a><br />
         		    4.2  <a href="UVQI_DO_XX.htm#QUQI_DO000003UV-ic2id">By Trigger Event</a><br />
         		    4.3  <a href="UVQI_DO_XX.htm#QUQI_DO000003UV-ic3id">By Message Type</a><br />5.  <a href="uvqi_glossary.htm#">Glossary</a><br /><div class="body">
            <div class="subSection">
               <div class="header">
                  <h3><a name="prefBegin">Preface</a></h3>
               </div>
            </div>
            <div class="subSection">
               <div class="header"><span class="icon"> </span><span class="number">i </span><span class="title"><a name="prefNotes">Notes to Readers</a></span></div>
               <div class="body">
                  <p>This represents the normative content for Version 3, Release 1.</p>
               </div>
            </div>
            <div class="subSection">
               <div class="header"><span class="icon"> </span><span class="number">ii </span><span class="title"><a name="navigate-divs">Message Design Element Navigation</a></span></div>
               <div class="body">
                  <table class="artifactList">
                     <tr>
                        <td class="artifactList_desc">
                           <table cellpadding="0" cellspacing="0" style="border:0px" class="help_table">
                              <tr id="d0e87" class="toc_title_row" onclick="toggle(this);" style="cursor: hand;" onmouseover="highlightRow(this,1);" onmouseout="highlightRow(this,0);">
                                 <td valign="top" colspan="10"><span class="toc_title_arrow">&#9660;</span><span class="toc_title_text"><strong>Query Control Act Request : Parameter List&nbsp;<a href="../../domains/uvqi/uvqi_QueryByParameter.htm#QUQI_RM020000UV01-rmi" class="toc_link">QUQI_RM020000UV01</a></strong></span></td>
                              </tr>
                              <tr class="toc_row_master">
                                 <td class="toc_indent_flag_gap"> </td>
                                 <td valign="top">
                                    <table cellpadding="0" cellspacing="0" style="border:0px" class="help_table">
                                       <tr id="d0e89" class="toc_title_row" onclick="toggle(this);" style="cursor: hand;" onmouseover="highlightRow(this,1);" onmouseout="highlightRow(this,0);">
                                          <td valign="top" colspan="10"><span class="toc_title_arrow">&#9660;</span><span class="toc_title_text"><strong>Query Control Act Request : Parameter List&nbsp;<a href="../../domains/uvqi/uvqi_QueryByParameter.htm#QUQI_HD020000UV01-hmd" class="toc_link">QUQI_HD020000UV01</a></strong></span></td>
                                       </tr>
                                       <tr class="toc_row_master">
                                          <td class="toc_indent_flag_gap"> </td>
                                          <td valign="top">
                                             <table cellpadding="0" cellspacing="0" style="border:0px">
                                                <tr>
                                                   <td>
                                                      <table style="border:0px" cellspacing="0" cellpadding="0">
                                                         <tr>
                                                            <td valign="top" align="left" class="general"><img src="../../support/graphics/pointer.gif" alt="pointer" /></td>
                                                            <td valign="top" align="left" class="general">Query Control Act Request : Parameter List&nbsp;<a href="../../domains/uvqi/uvqi_QueryByParameter.htm#QUQI_MT020001UV01-msg" class="">QUQI_MT020001UV01</a></td>
                                                         </tr>
                                                      </table>
                                                   </td>
                                                </tr>
                                             </table>
                                          </td>
                                       </tr>
                                    </table>
                                 </td>
                              </tr>
                           </table>
                           <table cellpadding="0" cellspacing="0" style="border:0px" class="help_table">
                              <tr id="d0e93" class="toc_title_row" onclick="toggle(this);" style="cursor: hand;" onmouseover="highlightRow(this,1);" onmouseout="highlightRow(this,0);">
                                 <td valign="top" colspan="10"><span class="toc_title_arrow">&#9660;</span><span class="toc_title_text"><strong>Query Control Act Request : Query By Parameter&nbsp;<a href="../../domains/uvqi/uvqi_QueryByParameter.htm#QUQI_RM021000UV01-rmi" class="toc_link">QUQI_RM021000UV01</a></strong></span></td>
                              </tr>
                              <tr class="toc_row_master">
                                 <td class="toc_indent_flag_gap"> </td>
                                 <td valign="top">
                                    <table cellpadding="0" cellspacing="0" style="border:0px" class="help_table">
                                       <tr id="d0e95" class="toc_title_row" onclick="toggle(this);" style="cursor: hand;" onmouseover="highlightRow(this,1);" onmouseout="highlightRow(this,0);">
                                          <td valign="top" colspan="10"><span class="toc_title_arrow">&#9660;</span><span class="toc_title_text"><strong>Query Control Act Request : Query By Parameter&nbsp;<a href="../../domains/uvqi/uvqi_QueryByParameter.htm#QUQI_HD021000UV01-hmd" class="toc_link">QUQI_HD021000UV01</a></strong></span></td>
                                       </tr>
                                       <tr class="toc_row_master">
                                          <td class="toc_indent_flag_gap"> </td>
                                          <td valign="top">
                                             <table cellpadding="0" cellspacing="0" style="border:0px">
                                                <tr>
                                                   <td>
                                                      <table style="border:0px" cellspacing="0" cellpadding="0">
                                                         <tr>
                                                            <td valign="top" align="left" class="general"><img src="../../support/graphics/pointer.gif" alt="pointer" /></td>
                                                            <td valign="top" align="left" class="general">Query Control Act Request : Query By Parameter&nbsp;<a href="../../domains/uvqi/uvqi_QueryByParameter.htm#QUQI_MT021001UV01-msg" class="">QUQI_MT021001UV01</a></td>
                                                         </tr>
                                                      </table>
                                                   </td>
                                                </tr>
                                             </table>
                                          </td>
                                       </tr>
                                    </table>
                                 </td>
                              </tr>
                           </table>
                           <table cellpadding="0" cellspacing="0" style="border:0px" class="help_table">
                              <tr id="d0e99" class="toc_title_row" onclick="toggle(this);" style="cursor: hand;" onmouseover="highlightRow(this,1);" onmouseout="highlightRow(this,0);">
                                 <td valign="top" colspan="10"><span class="toc_title_arrow">&#9660;</span><span class="toc_title_text"><strong>Query Control Act Request Continue / Cancel&nbsp;<a href="../../domains/uvqi/uvqi_QueryByParameter.htm#QUQI_RM000001UV01-rmi" class="toc_link">QUQI_RM000001UV01</a></strong></span></td>
                              </tr>
                              <tr class="toc_row_master">
                                 <td class="toc_indent_flag_gap"> </td>
                                 <td valign="top">
                                    <table cellpadding="0" cellspacing="0" style="border:0px" class="help_table">
                                       <tr id="d0e101" class="toc_title_row" onclick="toggle(this);" style="cursor: hand;" onmouseover="highlightRow(this,1);" onmouseout="highlightRow(this,0);">
                                          <td valign="top" colspan="10"><span class="toc_title_arrow">&#9660;</span><span class="toc_title_text"><strong>Query Control Act Request Continue / Cancel&nbsp;<a href="../../domains/uvqi/uvqi_QueryByParameter.htm#QUQI_HD000001UV01-hmd" class="toc_link">QUQI_HD000001UV01</a></strong></span></td>
                                       </tr>
                                       <tr class="toc_row_master">
                                          <td class="toc_indent_flag_gap"> </td>
                                          <td valign="top">
                                             <table cellpadding="0" cellspacing="0" style="border:0px">
                                                <tr>
                                                   <td>
                                                      <table style="border:0px" cellspacing="0" cellpadding="0">
                                                         <tr>
                                                            <td valign="top" align="left" class="general"><img src="../../support/graphics/pointer.gif" alt="pointer" /></td>
                                                            <td valign="top" align="left" class="general">Query Control Act Request Continue / Cancel&nbsp;<a href="../../domains/uvqi/uvqi_QueryByParameter.htm#QUQI_MT000001UV01-msg" class="">QUQI_MT000001UV01</a></td>
                                                         </tr>
                                                      </table>
                                                   </td>
                                                </tr>
                                             </table>
                                          </td>
                                       </tr>
                                    </table>
                                 </td>
                              </tr>
                           </table>
                           <table cellpadding="0" cellspacing="0" style="border:0px" class="help_table">
                              <tr id="d0e105" class="toc_title_row" onclick="toggle(this);" style="cursor: hand;" onmouseover="highlightRow(this,1);" onmouseout="highlightRow(this,0);">
                                 <td valign="top" colspan="10"><span class="toc_title_arrow">&#9660;</span><span class="toc_title_text"><strong>Query Control Act Response / Acknowledgement&nbsp;<a href="../../domains/uvqi/uvqi_QueryByParameter.htm#QUQI_RM120000UV01-rmi" class="toc_link">QUQI_RM120000UV01</a></strong></span></td>
                              </tr>
                              <tr class="toc_row_master">
                                 <td class="toc_indent_flag_gap"> </td>
                                 <td valign="top">
                                    <table cellpadding="0" cellspacing="0" style="border:0px" class="help_table">
                                       <tr id="d0e107" class="toc_title_row" onclick="toggle(this);" style="cursor: hand;" onmouseover="highlightRow(this,1);" onmouseout="highlightRow(this,0);">
                                          <td valign="top" colspan="10"><span class="toc_title_arrow">&#9660;</span><span class="toc_title_text"><strong>Query Control Act Response / Acknowledgement&nbsp;<a href="../../domains/uvqi/uvqi_QueryByParameter.htm#QUQI_HD120000UV01-hmd" class="toc_link">QUQI_HD120000UV01</a></strong></span></td>
                                       </tr>
                                       <tr class="toc_row_master">
                                          <td class="toc_indent_flag_gap"> </td>
                                          <td valign="top">
                                             <table cellpadding="0" cellspacing="0" style="border:0px">
                                                <tr>
                                                   <td>
                                                      <table style="border:0px" cellspacing="0" cellpadding="0">
                                                         <tr>
                                                            <td valign="top" align="left" class="general"><img src="../../support/graphics/pointer.gif" alt="pointer" /></td>
                                                            <td valign="top" align="left" class="general">Query Control Act Response / Acknowledgement&nbsp;<a href="../../domains/uvqi/uvqi_QueryByParameter.htm#QUQI_MT120001UV01-msg" class="">QUQI_MT120001UV01</a></td>
                                                         </tr>
                                                      </table>
                                                   </td>
                                                </tr>
                                             </table>
                                          </td>
                                       </tr>
                                    </table>
                                 </td>
                              </tr>
                           </table>
                        </td>
                     </tr>
                  </table><br /></div>
            </div>
            <hr title="Separator from body" />
            <div class="subSection">
               <div class="header"><span class="icon"><img src="../../support/graphics/NormativeStandard.gif" alt="NormativeStandard1" /></span><span class="number">1 </span><span class="title"><a name="intro-QUQI_DO000003UV-ic">Overview</a></span></div>
               <div class="body">
                  <div class="subSubSection">
                     <div class="header"><span class="icon"> </span><span class="number">1.1 </span><span class="title"><a name="spec-scope">Introduction &amp; Scope</a></span></div>
                     <div class="body">
                        <p><strong>Scope</strong></p>
                        <p>The Query Infrastructure domain specifies the formation of information queries and the responses to these queries to meet
                           the needs of healthcare applications using the HL7 version 3 messaging standard.
                           
                        </p>
                        <p><strong>Introduction</strong></p>
                        <p>The Health Level Seven (HL7) Standard applies to the electronic exchange of data in all healthcare environments.  Within the
                           context of healthcare messaging, the HL7 standard is primarily concerned with the data content of exchanges between healthcare
                           applications, the sequence or interrelationships in the flow of messages and the communication of significant application
                           level exceptions or error conditions.
                           
                        </p>
                        <p>This chapter addresses the formation of information queries and the responses to these queries to meet the needs of healthcare
                           applications using the HL7 version 3 messaging standard. 
                           
                        </p>
                        <p><strong>Overview of Query Requests and Responses in HL7 Messaging in Version 3</strong></p>
                        <p>Queries in Version 3 are supported by a generic framework for expressing (a) common queries that have been used by applications
                           using the HL7 standard or (b) new queries that can be specified by a valid use case in the domain of healthcare information
                           management.  It is the intent of the HL7 Standard to facilitate establishing such interactions between heterogeneous applications.
                        </p>
                        <p>The HL7 Standard embraces the most common queries that are likely to occur. These are defined within functional application
                           domains. The following represents typical examples of queries supported by the Standard:
                           
                        </p>
                        <ol>
                           <li>
                              <p>data regarding a single patient, e.g., send all lab results for patient #123456</p>
                           </li>
                           <li>
                              <p>data regarding multiple patients, e.g., send the list of patients whose attending physician is Dr. #123</p>
                           </li>
                           <li>
                              <p>data that are not patient related, e.g., send the age specific normal values for serum protein</p>
                           </li>
                           <li>
                              <p>data within a specified time range, e.g., send all serum glucose results, reported between January 1, 1998 through December
                                 31, 1999, for patient #123456
                              </p>
                           </li>
                        </ol>
                        <p>The variety of potential queries is almost unlimited.  HL7 does not try to cover every possible query.  Rather, the Standard
                           provides general methods by which to structure query/response pairs.  The technical committees responsible for functional
                           domains apply these methods to develop specific query/response pairs for those domains' needs.
                           
                        </p>
                        <p>In particular, there is no implication that a specific system must support generalized queries to comply with the Standard.
                           Rather, these transactions provide a format by which a system may support queries to the extent it desires.  The resources
                           available and local policies will influence the type of queries that are implemented.
                           
                        </p>
                        <p><em>Query Development Methodology Summary</em></p>
                        <p>An institution, or data owner, decides that it would like to make information available via a query.  It decides precisely
                           what data will be made available and how it will be offered.  
                           
                        </p>
                        <p>The data owner specifies exactly which input variables the data requestor can use to control the data that the data owner
                           agrees to return.  
                           The complete specification of what data are available, how the data will be returned, and what variables can be valued or
                           constrained should be provided for both the query and the response.
                        </p>
                        <p>An example of the application of this methodology is provided for a set of <em>MPI person/patient</em> queries that are presented in the Patient Administration Query Domain discussion.
                           
                        </p>
                        <p><em>Framework for Supporting a Query by Parameter Mechanism</em></p>
                        <p>HL7 Version 3 offers a <em>query by parameter</em> mechanism.  A data-requesting application sends values within a set of input parameters as specified by a data-serving application.
                           The data-serving application processes the input parameter values sent to it, and constructs a result set, which it returns
                           (in whole or in parts) to the data-requesting application.
                        </p>
                        <p>The specification process for the query and response is outlined below.  Afterward, we discuss the mechanism for continuing
                           or canceling an established HL7 query session. 
                           
                        </p>
                        <p>The Query Specification Message
                           
                        </p>
                        <p>The structure of an HL7 V3 composite message payload for a query specification consists of three parts
                           :
                        </p>
                        <ul style="margin-left:20px;">
                           <li>
                              <p>The HL7 transmission wrapper.  Refer to <a href="../../domains/uvci/uvci.htm#MCCI_DM000000UV-rmi" class="">Transmission Infrastructure</a></p>
                           </li>
                           <li>
                              <p>A query specification control act</p>
                           </li>
                           <li>
                              <p>A parameter definition structure that is specified as required for each domain defined query</p>
                           </li>
                        </ul>
                        <p>The parameter definition structure for the <em>query by parameter</em> query specification is an information structure that may be similar in form for many query implementations but differentiated
                           by constraints on attribute values as described as follows.  Input variables are specified by parameter repetitions.   The
                           query by parameter specification mechanism also supports the identification of a name of a list of parameter values followed
                           by a parameter repetition.  Refer to the <a href="../../domains/uvqi/uvqi.htm#QUQI_DM000000UV-rmi" class="">Query Infrastructure D-MIM</a> walk-through for details on classes and attributes.
                           
                        </p>
                        <p>The parameter definition structure is essentially the domain committee-defined content for a query specification message.
                           This structure is conveyed in the intermediate query specification control act.
                           
                        </p>
                        <p>The Query Response Message
                           
                        </p>
                        <p>An HL7 V3 composite <em>Query Response Message</em> is prepared by an HL7 V3 Query Fulfiller application role in response to receiving a <em>Query Specification Message</em>.  The structure of this HL7 V3 composite message payload consists of the HL7 transmission wrapper, a query response control
                           act and a domain committee-defined message type.
                           
                        </p>
                        <p>The query response control act requires only one attribute to identify the query session to which the query response message
                           is associated.  Refer to the <a href="../../domains/uvqi/uvqi.htm#QUQI_DM000000UV-rmi" class="">Query Infrastructure D-MIM</a> walk-through for details of the classes and attributes.
                           
                        </p>
                        <p>The domain committee-defined query response structure is RIM content specified as a V3 message type artifact.  It has an identifier
                           that appears in the query specification.  It should be noted that a domain committee might define one query response structure
                           that is the focus of several query specification messages.
                           
                        </p>
                        <p>The Query Continuation Message
                           
                        </p>
                        <p>The <em>Query Continuation Message</em> is a query control message that applies to the logical level of a query session that is controlled by the applications that
                           implement the HL7 V3 Query Placer and Query Fulfiller application roles.  The structure of this HL7 V3 composite message payload
                           consists of the HL7 transmission wrapper and a minimal query control act.  The control act only requires a subset of the attributes
                           and a minimum of query continuation attributes.  Refer to the <a href="../../domains/uvqi/uvqi.htm#QUQI_DM000000UV-rmi" class="">Query Infrastructure D-MIM</a> walk-through for details of the classes and attributes. The query identifier uniquely defines the query session in progress
                           and the continuation quantity defines the application specified quantity to be return by the next interaction with the Query
                           Fulfiller application role.  If this numeric value is a positive integer a query continuation is requested.  If this integer
                           value is zero, a cancellation of the query session it requested.
                           
                        </p>
                        <p><em>Query Control Events Overview</em></p>
                        <p>Query control in HL7 Version 3 is defined by the handling of the events and state transitions identified in the Version 3
                           HL7 Query Control state diagram (see the Version 3 Query Control State Diagram below).  Initially, a pair of HL7 Version 3
                           Application Roles (described in the application roles section of the <b>(The user identified specification IMQUQI 
                              is not available)</b>  topic) is provided for managing queries.  The pair of roles defined must manage the states and state transitions that are
                           specific to this generic query framework. 
                           
                        </p>
                        <p>Example interactions for which the pair of HL7 Applications Roles for query management participates are documented in the
                           message control interactions section of the <b>(The user identified specification IMQUQI 
                              is not available)</b>  topic.  Each interaction is initiated by a query control state transition that is assigned a Query Control Trigger Event.
                           Refer to the trigger events section of the <b>(The user identified specification IMQUQI 
                              is not available)</b> topic for detailed descriptions of the Version 3 Query Control Trigger Events.
                           
                        </p>
                        <p><br /><img class="graphic" src="graphics/QUQI_NA000001.gif" alt="Version 3 Query Control State Diagram" /><br />Version 3 Query Control State Diagram<br /></p>
                     </div>
                  </div>
               </div>
            </div>
            <div class="subSection">
               <div class="header"><span class="icon"> </span><span class="number">1.2</span><span class="title"><a name="dmims-QUQI_DO000003UV-ic">Domain Message Information Models</a></span><hr class="sectionrule" />
               </div>
               <div class="body">
                  <div class="subSubSection">
                     <div class="header"><span class="icon"> </span><span class="number"></span><span class="title"><a name="QUQI_DM000000UV-rmi">Query Control Act  (QUQI_DM000000UV) </a></span></div>
                     <div class="body">
                        <div class="heading">
                           <p>Diagram</p>
                        </div><a style="border:0px solid none;" href="editable/QUQI_DM000000UV.htm" target="_blank"><img class="graphic" src="editable/images/T-QUQI_DM000000UV.png" alt="" /><br />
                           						Click thumbnail above to open larger graphic in a new window
                           					</a><p></p>
                        <div class="heading">Description</div>
                        <p><strong>The Query Specification Message </strong></p>
                        <p>A <em>query by parameter</em> mechanism is provided for defining a query specification.  The structure of an HL7 V3 composite message for a query specification
                           consists of the HL7 transmission wrapper, a query specification control act and a parameter definition structure that is specified
                           as required for each domain defined query request message type. 
                        </p>
                        <p>The parameter definition structure for the <em>query by parameter</em> query specification is an information structure that may be similar in form for many query implementations but differentiated
                           by constraints on attribute values as described as follows.  This chapter includes two R-MIMs for query by parameter specification.
                           One that allows domains to define the full query by parameter specification and one that allows them specify only the parameter
                           items.  
                        </p>
                        <p>Refer to the walk-through below for details on classes and attributes.</p>
                        <p><strong>The Query Response Message</strong></p>
                        <p>An HL7 V3 composite <em>Query Response Message</em> is prepared by an HL7 V3 Query Fulfiller application role in response to receiving a <em>Query Specification Message</em>.  The structure of this HL7 V3 composite message consists of the HL7 transmission wrapper, a query response control act and
                           a domain defined message type. 
                        </p>
                        <p>Refer to the walk-through below for details of the classes and attributes. </p>
                        <p><strong>The Query Continuation Message </strong></p>
                        <p>The <em>Query Continuation Message</em> is a query control message that applies to the logical level of a query session that is controlled by the applications that
                           implement the HL7 V3 Query Placer and Query Fulfiller application roles.  The structure of this HL7 V3 composite message consists
                           of the HL7 transmission wrapper and a minimal query control act.  
                        </p>
                        <p>Refer to the walk-through below for details of the classes and attributes. </p>
                        <div class="heading"><br /><b class="heading">Design Walk-through</b></div>
                        <p><strong>Overview</strong></p>
                        <p>The Query Infrastructure domain comprises the classes and attributes needed to support queries, responses, and continuation
                           requests.  It is an extension of the <a href="../../domains/uvai/uvai.htm#intro-MCAI_DO000000UV-ic" class="">Message Control Act Infrastructure</a> domain.
                        </p>
                        <p><strong>Trigger Events and Control Acts</strong></p>
                        <p>The query storyboards, application roles, trigger events and interactions provided in this domain are for example purposes
                           only.  Domains will define these within their query definitions.
                        </p>
                        <p>The initial interaction generates messages as a result of the trigger events Execute Query Specification (by the data requester)
                           and Complete Query Response (by the data server).
                        </p>
                        <p>If the data requester has asked that results be sent back in partial sets, subsequent interactions may generate messages as
                           a result of the trigger events Activate Query Continuation (by the data requester) and Complete Query Continuation (by the
                           data server).  This pair of trigger events continues for as long as the data requester wants to continue receiving result
                           sets.  It ceases when the data server runs out of qualifying data or the data requester does not want any more result sets.
                        </p>
                        <p>All query messages are centered on the ControlActProcess act, which is discussed further below and is described fully in the
                           <a href="../../domains/uvai/uvai.htm#intro-MCAI_DO000000UV-ic" class="">Message Control Act Infrastructure</a> domain.
                        </p>
                        <p><strong>Focal Classes Exposed</strong></p>
                        <p>The ControlActProcess act, as constrained within the Query domain, constitutes the trigger event control act within which
                           the query payload classes are contained.  Its associations facilitate the production of queries by data requesters and of
                           responses by data servers.
                        </p>
                        <p>The dynamic model for query-response is that of a request for data by some interested system, followed by the production of
                           a response by a server.  Thus, the mood code for ControlActProcess will always be Order from the data requester and Event
                           from the data server.
                        </p>
                        <p><strong>Query D-MIM Core Structure</strong></p>
                        <p>The structure of the query D-MIM supports both the initial query-response interaction and subsequent interactions.</p>
                        <p>In the initial query-response interaction, the payload from the data requester will consist of exactly one instance of the
                           QueryByParameter class.  This class in turn will be associated with at least one instance of the Parameter class (either ParameterList
                           or one to many ParameterItem) and may also be associated with instance(s) of the SortControl class. The payload from the data
                           server will consist of exactly one instance of the QueryAck class, containing summary information about the response and about
                           the data (if any) that it contains.  This is followed by the actual response data, if there are any, structured as instances
                           of RIM classes that are associated with the QueryAck class.  The associations within the response payload are elaborated upon
                           in the definition of the specific query being used.
                        </p>
                        <p>If all the response data could not be returned in one result set, there will be additional query-response interactions.  In
                           subsequent interactions, the payload from the data requester will consist of exactly one instance of the QueryContinuation
                           class, in which the data requester specifies how much more data it would like to receive, if any.  As in the initial interaction,
                           the payload from the data server will consist of an instance of the QueryAck class (containing summary data) and then the
                           actual response data, if there are any.
                        </p>
                        <p><strong>Query Domain Information Model Classes</strong></p>
                        <p><strong>ControlActProcess</strong></p>
                        <p>The core Act of the Query domain wrapper.  This Act contains information about the query message.  Its act relationships and
                           participations, while included in support of queries, contain information about the message itself rather than about the query.
                        </p>
                        <p>This class is described more fully in <a href="../../domains/uvai/uvai.htm#MCAI_DM700200UV-rmi" class="">Control Act Infrastructure D-MIM</a> walkthrough.
                        </p>
                        <p><strong>QueryByParameter</strong></p>
                        <p>This class contains information about the query.  Non-query message information is contained in ControlActProcess.  This is
                           the entry point for those domain-defined queries that wish to fully express the query specifications, including sort order.
                           The key attribute of this class is queryId, which is used to associate this query instance with both the initial response
                           message and with later query interactions.  Valuing queryId avoids the need for the QueryContinuation and QueryAck classes
                           (which also contain the queryId attribute) to carry as much detail information as is carried in the initial query.
                        </p>
                        <p>The requester values attributes of this class in the initial query interaction to specify the query's priority, whether data
                           should be returned immediately or later, to specify a delivery time if desired, and to indicate how many records (i.e., instances
                           of matching response data) it would like to receive in each response message.  
                        </p>
                        <p>The following is the description and use of the attributes for QueryByParameter class.</p>
                        <ul>
                           <li>
                              <p><em>queryId</em>: may be valued by the initiating application to identify the query (it is intended to be used to match response messages
                                 to the originating query and may remain the same across multiple interactions when performing continuations of a previous
                                 query)
                              </p>
                           </li>
                           <li>
                              <p><em>statusCode</em>: defined by the QueryEventStatus domain (required)
                              </p>
                           </li>
                           <li>
                              <p><em>modifyCode</em>: indicates whether the subscription to a query is new or is being modified
                              </p>
                           </li>
                           <li>
                              <p><em>responseElementGroupId</em>: identifies the specific message type to be returned in the query response (this message type must be chosen from the set
                                 of message types supported by the receiver responsibilities associated with the query interaction)
                              </p>
                           </li>
                           <li>
                              <p><em>responseModalityCode</em>: defines the timing and grouping of the response instances
                              </p>
                           </li>
                           <li>
                              <p><em>responsePriorityCode</em>: identifies the time frame in which the response is expected
                              </p>
                           </li>
                           <li>
                              <p><em>initialQuantity</em>: defines the maximum size of the response that can be accepted by the requesting application.
                              </p>
                           </li>
                           <li>
                              <p><em>initialQuantityCode</em>: defines the units associated with the magnitude of the maximum size limit of a query response that can be accepted by the
                                 requesting application (defined by the QueryRequestLimit domain)
                              </p>
                           </li>
                           <li>
                              <p><em>executionAndDeliveryTime</em>: specifies the time the response is to be returned
                              </p>
                           </li>
                        </ul>
                        <p><strong>QueryContinuation</strong></p>
                        <p>This class is instantiated by the requester in subsequent query interactions if needed.  It references query information through
                           the value contained in the queryId attribute.  The requester may specify a differently-sized return payload or may request
                           that the next data set be started at any point.
                        </p>
                        <p>The following is the description and use of the attributes for this class.</p>
                        <ul>
                           <li>
                              <p><em>queryId</em>: may be valued by the initiating application to identify the query (it is intended to be used to match response messages
                                 to the originating query and may remain the same across multiple interactions when performing continuations of a previous
                                 query)
                              </p>
                           </li>
                           <li>
                              <p><em>statusCode</em>: defined by the QueryEventStatus domain (required)
                              </p>
                           </li>
                           <li>
                              <p><em>startResultNumber</em>: specifies the instance number in the original query result set to start return in next query response message
                              </p>
                           </li>
                           <li>
                              <p><em>continuationQuantity</em>: specifies the number of instance matches to return in the next query response message
                              </p>
                           </li>
                        </ul>
                        <p><strong>QueryAck</strong></p>
                        <p>The server returns an instance of this class both in the initial response (even if no matching data are returned) and continuation
                           responses, if any.  It references query information through the value contained in the queryId attribute. 
                        </p>
                        <p>The following is the description and use of the attributes for this class.</p>
                        <ul>
                           <li>
                              <p><em>queryId</em>: may be valued by the initiating application to identify the query (it is intended to be used to match response messages
                                 to the originating query and may remain the same across multiple interactions when performing continuations of a previous
                                 query)
                              </p>
                           </li>
                           <li>
                              <p><em>queryResponseCode</em>: allows the responding system to return a precise response status (values defined by the QueryStatus domain
                              </p>
                           </li>
                           <li>
                              <p><em>resultTotalQuantity</em>: specifies the total number of instance matches for query specification associated with this query response instance
                              </p>
                           </li>
                           <li>
                              <p><em>resultCurrentQuantity</em>: specifies the number of matches for processed query specification that occur in current bundle of matches
                              </p>
                           </li>
                           <li>
                              <p><em>resultRemainingQuantity</em>: specifies number of matches for processed query specification that have yet to be sent to receiver
                              </p>
                           </li>
                        </ul>
                        <p><strong>Parameter</strong></p>
                        <p>Sent in the initial query payload.  Note that the DMIM includes both QueryByParameter and Parameter as domain entry point
                           stubs.  The <a class="">QueryByParameter as Stub RMIM</a> may be represented as either ParameterItem classes or the ParameterList class. The <a class="">ParameterList as Stub RMIM</a> is a grouping of ParameterItem classes.  The Parameter classes carry the values that specify the data that the requester
                           wishes to be returned. The ParameterItem class is instantiated as many times as there are parameters to be sent, but in any
                           case at least once. ParameterList is the entry point for many of the domain-defined queries.
                        </p>
                        <p>If continuation interactions are required in order to bring back additional results, the continuation messages will not contain
                           this class.
                        </p>
                        <p>Query definitions in the application domains state how the value and semanticsText attributes are to be populated.</p>
                        <p>The following is the description and use of the attributes for this class.</p>
                        <ul>
                           <li>
                              <p><em>id</em>: can assist in tracing problems with implementing the query-by-parameter mechanism
                              </p>
                           </li>
                           <li>
                              <p><em>value</em>: represents a valued element structure for the element specified in the query response
                              </p>
                           </li>
                           <li>
                              <p><em>semanticsText</em>: provides a unique identification to an element within a specified query response structure
                              </p>
                           </li>
                        </ul>
                        <p><strong>SortControl</strong></p>
                        <p>Sent in the initial query payload.  This class allows the requester to specify the order in which the server should return
                           multiple results.  If used, it is instantiated only once.
                        </p>
                        <p>If continuation interactions are required in order to bring back additional results, the continuation messages will not contain
                           this class.
                        </p>
                        <p>The following is the description and use of the attributes for this class.</p>
                        <ul>
                           <li>
                              <p><em>sequenceNumber</em>: specifies the order
                              </p>
                           </li>
                           <li>
                              <p><em>elementName</em>: identifies a RIM element in a query response
                              </p>
                           </li>
                           <li>
                              <p><em>directionCode</em>: specifies sequence of sort order (values are ascending, descending, or none)
                              </p>
                           </li>
                        </ul>
                        <p><strong>Act</strong></p>
                        <p>This class connects the query response (either initial or continuation) with the top or outermost application class that is
                           instantiated for the response.
                        </p>
                        <p><strong>Participations</strong></p>
                        <p>The following control act participations are defined for the query control act.  Note that where the model permits more than
                           one instance of (or requires) a participation or act relationship, cardinality should be constrained as fully as possible
                           in the domain-defined message type. Note that the location for any of the participants, if provided, will be defined in the
                           R_AssignedPerson CMET.
                        </p>
                        <ul>
                           <li>
                              <p><em>authorOrPerformer</em>:  Who or what is asking for the information.  More than one overseer may exist; this participation is not required.  This
                                 participation associates the query act with either an entity that is described in an instance of the R_AssignedEntity role
                                 class, or a device that is described in an instance of an instance of the R_AssignedDevice role CMET.
                              </p>
                           </li>
                           <li>
                              <p><em>overseer</em>:  The supervisor of the administrative person (dataEnterer) who physically places the query into the system.  More than one
                                 overseer may exist; this participation is not required.  This participation associates the query act with a person that is
                                 described in an instance of the R_AssignedPerson role CMET.
                              </p>
                           </li>
                           <li>
                              <p><em>dataEnterer</em>:  The administrative person who physically places the query into the system.  More than one dataEnterer may exist; this participation
                                 is not required.  This participation associates the query act with a person that is described in an instance of the R_AssignedPerson
                                 role CMET.
                              </p>
                           </li>
                           <li>
                              <p><em>informationRecipient</em>:  Who will get a copy of the returned data.   More than one informationRecipient may exist; this participation is not required.
                                 This participation associates the query act with a person that is described in an instance of the R_AssignedPerson role CMET.
                              </p>
                           </li>
                        </ul>
                        <p>Refer to the <a class="">Trigger Event Control Act Detected Issue Local CMET</a> walkthrough for details of the DetectedIssueEvent and DetectedIssueManagement.
                        </p>
                     </div>
                  </div>
               </div>
            </div>
            <p>
               <table>
                  <tbody>
                     <tr>
                        <td><a class="custombutton" href="#top">Return to top of page</a></td>
                     </tr>
                  </tbody>
               </table>
            </p>
         </div>
      </div>
   </body>
</html>